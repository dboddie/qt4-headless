Description: There should be no reason to disable stack protector unless one
 is building with an ancient version of GCC.
Author: Kees Cook <kees@ubuntu.com>
Bug-Ubuntu: https://launchpad.net/bugs/538237

Index: qt4-x11-4.6.2/mkspecs/qws/linux-lsb-g++/qmake.conf
===================================================================
--- qt4-x11-4.6.2.orig/mkspecs/qws/linux-lsb-g++/qmake.conf	2010-03-12 17:31:13.012541650 -0800
+++ qt4-x11-4.6.2/mkspecs/qws/linux-lsb-g++/qmake.conf	2010-03-13 10:12:41.300041895 -0800
@@ -12,11 +12,10 @@
 # modifications to g++.conf
 QMAKE_CC                = lsbcc
 QMAKE_CXX		= lsbc++
-QMAKE_CFLAGS		= -pipe -DQT_LINUXBASE -fno-stack-protector
+QMAKE_CFLAGS		= -pipe -DQT_LINUXBASE
 QMAKE_CXXFLAGS          = $$QMAKE_CFLAGS
 QMAKE_LINK              = lsbc++
 QMAKE_LINK_SHLIB        = lsbc++
-QMAKE_LFLAGS		+= -fno-stack-protector
 
 load(qt_config)
 
Index: qt4-x11-4.6.2/src/3rdparty/javascriptcore/JavaScriptCore/JavaScriptCore.pri
===================================================================
--- qt4-x11-4.6.2.orig/src/3rdparty/javascriptcore/JavaScriptCore/JavaScriptCore.pri	2010-03-13 10:12:57.650691670 -0800
+++ qt4-x11-4.6.2/src/3rdparty/javascriptcore/JavaScriptCore/JavaScriptCore.pri	2010-03-13 10:13:22.121291586 -0800
@@ -52,14 +52,6 @@
     CONFIG(debug):!contains(DEFINES, ENABLE_JIT=1): DEFINES+=ENABLE_JIT=0
 }
 
-# Rules when JIT enabled (not disabled)
-!contains(DEFINES, ENABLE_JIT=0) {
-    linux*-g++*:greaterThan(QT_GCC_MAJOR_VERSION,3):greaterThan(QT_GCC_MINOR_VERSION,0) {
-        QMAKE_CXXFLAGS += -fno-stack-protector
-        QMAKE_CFLAGS += -fno-stack-protector
-    }
-}
-
 wince* {
     INCLUDEPATH += $$QT_SOURCE_TREE/src/3rdparty/ce-compat
     SOURCES += $$QT_SOURCE_TREE/src/3rdparty/ce-compat/ce_time.c
Index: qt4-x11-4.6.2/src/3rdparty/webkit/JavaScriptCore/JavaScriptCore.pri
===================================================================
--- qt4-x11-4.6.2.orig/src/3rdparty/webkit/JavaScriptCore/JavaScriptCore.pri	2010-03-13 10:12:57.681293024 -0800
+++ qt4-x11-4.6.2/src/3rdparty/webkit/JavaScriptCore/JavaScriptCore.pri	2010-03-13 10:13:27.530148486 -0800
@@ -52,14 +52,6 @@
     CONFIG(debug):!contains(DEFINES, ENABLE_JIT=1): DEFINES+=ENABLE_JIT=0
 }
 
-# Rules when JIT enabled (not disabled)
-!contains(DEFINES, ENABLE_JIT=0) {
-    linux*-g++*:greaterThan(QT_GCC_MAJOR_VERSION,3):greaterThan(QT_GCC_MINOR_VERSION,0) {
-        QMAKE_CXXFLAGS += -fno-stack-protector
-        QMAKE_CFLAGS += -fno-stack-protector
-    }
-}
-
 wince* {
     INCLUDEPATH += $$QT_SOURCE_TREE/src/3rdparty/ce-compat
     SOURCES += $$QT_SOURCE_TREE/src/3rdparty/ce-compat/ce_time.c
